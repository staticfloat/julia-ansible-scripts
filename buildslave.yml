---
# Change this to whatever you want to run the provisioning process on
- hosts: julia_buildslave_ubuntu
  vars_files:
    - secret/vars.yml
  sudo: yes
  pre_tasks:
    # Save home directory to "home" envvar
    - shell: echo ~
      sudo: no
      register: home

  roles:
    # You've gotta be first, la!
    - role: server

    - role: julia_buildslave

    # Also add startup role to run biliserver/server.py
    - role: startup_script
      service_name: buildslave
      daemon: /usr/bin/python
      daemon_opts: "{{home.stdout}}/buildbot/sandbox/bin/buildslave start --nodaemon"
